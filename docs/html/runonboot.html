<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Robot Control Library: Making a Program Run on Boot</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Robot Control Library"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Robot Control Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('runonboot.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Making a Program Run on Boot </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Once your robot control project is operational, you will likely want it to start automatically every time the robot powers up. This is the primary function of the robotcontrol systemd service. This page will focus on using this service to make a program run on boot, for more details of the service see the <a href="background_services.html">background services</a> page.</p>
<p>The robotcontrol service will, when enabled, check that certain drivers have loaded and permissions have been set correctly on boot. In some cases, it will wait until slow-loading kernel modules have loaded completely to ensure your robot controller behaves predictably. This routine is accomplished by the rc_startup_routine program which is started by the service as an "ExecStartPre" prerequisite.</p>
<p>After rc_startup_routine has completed successfully, the service will then launch the user's desired program. It looks in /etc/librobotcontrol/ for an executable called link_to_startup_program.</p>
<p>To make YOUR program start on boot, simply make a symbolic link to your program with the name /etc/librobotcontrol/link_to_startup_program. You will have to be root to change this link, and the program itself will run as root when started by the systemd service. For example, to set the eduMiP rc_balance program example to run on boot, run:</p>
<div class="fragment"><div class="line">sudo ln -s -f /usr/bin/rc_balance /etc/robotcontrol/link_to_startup_program</div></div><!-- fragment --><p>If using the makefile from the rc_project_template (see the <a href="project_template.html">project template page</a>) you can form that link with:</p>
<div class="fragment"><div class="line">sudo make runonboot</div></div><!-- fragment --><p>After making the symbolic link, you can start, stop, restart, and check the status of your own robot program with the systemctl tool just like you would with apache2 and other common services.</p>
<div class="fragment"><div class="line">debian@beaglebone:~$ sudo systemctl status robotcontrol</div><div class="line">● robotcontrol.service - robotcontrol</div><div class="line">   Loaded: loaded (/lib/systemd/system/robotcontrol.service; enabled; vendor preset: enabled)</div><div class="line">   Active: active (running) since Fri 2018-04-20 07:56:28 UTC; 35min ago</div><div class="line">  Process: 453 ExecStartPre=/usr/bin/rc_startup_routine (code=exited, status=0/SUCCESS)</div><div class="line"> Main PID: 578 (link_to_startup)</div><div class="line">    Tasks: 7 (limit: 4915)</div><div class="line">   CGroup: /system.slice/robotcontrol.service</div><div class="line">           └─578 /etc/robotcontrol/link_to_startup_program</div><div class="line"></div><div class="line">debian@beaglebone:~$ sudo systemctl stop robotcontrol</div><div class="line">debian@beaglebone:~$ sudo systemctl start robotcontrol</div></div><!-- fragment --><p>Note that while your program is running in the background it is likely using hardware resources. If you try doing something simple like rc_test_leds while another project is running in the background then you WILL get conflicts, if not errors. Make sure to stop the background service as described above.</p>
<p>Both the rc_blink and rc_balance example programs which are offered as startup options during the package installation process make a PID file at /run/shm/robotcontrol.pid. You can have your program make a PID file too with rc_make_pid_file() and automatically stop the background process when it starts with rc_kill_existing_process(). If your program takes advantage of these features, you can also stop it from the command line with sudo rc_kill. See the <a href="group__start__stop.html">start-stop API module</a> for more details on how to manage a PID file properly with his library. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="manual.html">manual</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
